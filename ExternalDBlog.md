# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –ª–æ–≥–æ–≤ Moodle

–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Moodle –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

## –®–∞–≥ 1. –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É MariaDB/MySQL:
   ```bash
   mysql -u root -p
   ```

2. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ª–æ–≥–æ–≤:
   ```sql
   CREATE DATABASE moodle_log DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
   ```

3. –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –Ω—É–∂–Ω—ã–º–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏:
   ```sql
   GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, CREATE TEMPORARY TABLES, DROP, INDEX, ALTER
   ON moodle_log.* TO 'moodleuser'@'localhost' IDENTIFIED BY 'your_password';
   FLUSH PRIVILEGES;
   ```

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:
   ```bash
   mysql -u moodleuser -h 127.0.0.1 -p moodle_log
   ```

---

## –®–∞–≥ 2. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –ª–æ–≥–æ–≤

–°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É `mdl_logstore_standard_log` —Å –ø–æ–º–æ—â—å—é SQL-–∑–∞–ø—Ä–æ—Å–∞:

```sql
CREATE TABLE mdl_logstore_standard_log (
    id BIGINT(20) NOT NULL AUTO_INCREMENT,
    eventname VARCHAR(255) NOT NULL,
    component VARCHAR(100) NOT NULL,
    action VARCHAR(100) NOT NULL,
    target VARCHAR(100) NULL DEFAULT NULL,
    `objecttable` VARCHAR(50) NULL DEFAULT NULL,
    `objectid` BIGINT(20) NULL DEFAULT NULL,
    `crud` CHAR(1) NOT NULL,
    `edulevel` TINYINT(1) NOT NULL,
    contextid BIGINT(20) NOT NULL,
    contextlevel TINYINT(3) NOT NULL,
    contextinstanceid BIGINT(20) NOT NULL,
    userid BIGINT(20) NOT NULL,
    `courseid` BIGINT(20) NULL DEFAULT NULL,
    `relateduserid` BIGINT(20) NULL DEFAULT NULL,
    `anonymous` TINYINT(1) NOT NULL DEFAULT 0,
    `other` LONGTEXT NULL DEFAULT NULL,
    `timecreated` BIGINT(20) NOT NULL,
    `origin` VARCHAR(10) NULL DEFAULT NULL,
    `ip` VARCHAR(45) NULL DEFAULT NULL,
    `realuserid` BIGINT(20) NULL DEFAULT NULL,
    PRIMARY KEY (id),
    INDEX eventname_idx (eventname),
    INDEX courseid_idx (courseid),
    INDEX userid_idx (userid),
    INDEX contextid_idx (contextid),
    INDEX contextlevel_idx (contextlevel),
    INDEX contextinstanceid_idx (contextinstanceid),
    INDEX timecreated_idx (timecreated)
) ENGINE=InnoDB DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

---

## –®–∞–≥ 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Moodle –¥–ª—è –Ω–æ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

1. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –≤ Moodle –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä.
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞ > –ü–ª–∞–≥–∏–Ω—ã > –õ–æ–≥–∏ > –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∞–º–∏
3. –ù–∞–π–¥–∏—Ç–µ **"–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ª–æ–≥–æ–≤"** –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É **"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"**.
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

| –ü–æ–ª–µ                          | –ó–Ω–∞—á–µ–Ω–∏–µ                                                                                |
|-------------------------------|----------------------------------------------------------------------------------------|
| **–¢–∞–±–ª–∏—Ü–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**        | `mdl_logstore_standard_log`                                                            |
| **–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ**      | `–î–∞`                                                                                   |
| **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Unix-—Å–æ–∫–µ—Ç** | –û—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è TCP/IP)                                            |
| **–ü–æ—Ä—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**           | `3306`                                                                                 |
| **–•–æ—Å—Ç**                       | `127.0.0.1`                                                                            |
| **–°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**          | `moodle_log`                                                                           |
| **–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** | `moodleuser`                                                                        |
| **–ü–∞—Ä–æ–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**         | –£–∫–∞–∂–∏—Ç–µ –ø–∞—Ä–æ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –∑–∞–¥–∞–Ω –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `moodleuser`.                       |
| **–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**  | –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `utf8mb4_unicode_ci` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).                       |
| **–†–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞**              | `512` (—Å—Ç–æ–∏—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 512KB –∏–ª–∏ 1MB –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π).             |
| **–§–æ—Ä–º–∞—Ç JSON**                | `–°–∂–∞—Ç—ã–π —Ç–µ–∫—Å—Ç` (Compressed text).                                                     |

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

---

## –®–∞–≥ 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

Moodle –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –Ω–æ–≤–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –æ—à–∏–±–∫–∏, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, —Ç–∞–±–ª–∏—Ü—É –∏ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–†–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞:**
   - –î–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ç–µ–Ω–¥–æ–≤ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å **50KB**.
   - –î–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **512KB** –∏–ª–∏ **1MB**.

2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤:**
   –í –∞–¥–º–∏–Ω–∫–µ Moodle –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞ > –°–µ—Ä–≤–µ—Ä > –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
3. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑:
     ```sql
     SHOW GRANTS FOR 'moodleuser'@'localhost';
     ```
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ MariaDB —Å–ª—É—à–∞–µ—Ç –Ω–∞ –Ω—É–∂–Ω–æ–º –ø–æ—Ä—Ç—É –≤ —Ñ–∞–π–ª–µ `/etc/mysql/my.cnf`.

---

–¢–µ–ø–µ—Ä—å –ª–æ–≥–∏ Moodle –¥–æ–ª–∂–Ω—ã –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –≤ –Ω–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö `moodle_log`!

–î–ª—è –ª—é–±—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ —É—Ç–æ—á–Ω–µ–Ω–∏–π –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å.üòä
